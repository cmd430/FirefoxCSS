:root[uidensity="compact"] {
  --tab-min-height: 31px !important;
  --tab-spacer-width: 16px;
  --toolbarbutton-inner-padding-precalc: calc((var(--tab-min-height) / 8) / 2) !important;
  --toolbarbutton-outer-padding-precalc: calc(var(--toolbarbutton-outer-padding) * 1.5);
  --pin-unpin-edge-padding: var(--tab-spacer-width);

  @supports -moz-bool-pref("userChrome.UltraCompact") { // Ultra Compact Mode
    --tab-min-height: 25px !important;
  }

  #titlebar {
    appearance: auto !important;
    -moz-default-appearance: none !important;
  }
  #TabsToolbar {
    toolbarbutton{
      &.titlebar-button {
        padding: 4px 17px !important;
      }
    }
  }
  #tabbrowser-tabs:not([secondarytext-unsupported]) tab.tabbrowser-tab:not(:hover) {
   & .tab-icon-stack:not([sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked], [crashed]) > :not(.tab-icon-overlay) {
      opacity: 0 !important;
    }
    & .tab-icon-overlay:not([sharing], [crashed]):is([soundplaying], [muted], [activemedia-blocked]) {
      opacity: 1 !important;
    }
  }
}
